<!DOCTYPE html>
<html>
<head>

<title>Donor List</title>

<style>

body{
font-family:Arial;
background:#f4f6f8;
padding:20px;
}

.top{
display:flex;
gap:10px;
margin-bottom:20px;
}

input,select{
padding:8px;
}

.donor-card{
background:white;
padding:15px;
margin-bottom:12px;
border-radius:8px;
box-shadow:0px 2px 6px rgba(0,0,0,.15);
}

button{
background:#b91c1c;
color:white;
border:none;
padding:6px 12px;
border-radius:5px;
cursor:pointer;
}

button:hover{
background:#991b1b;
}

</style>

</head>

<body>

<h2>Registered Donors</h2>

<div class="top">

<input id="search" placeholder="Search donor">

<select id="blood">

<option value="all">All Blood</option>

<option>A+</option>
<option>A-</option>
<option>B+</option>
<option>B-</option>
<option>AB+</option>
<option>AB-</option>
<option>O+</option>
<option>O-</option>

</select>

</div>

<div id="donorCount"></div>

<div id="donorsList">

Loading donors...

</div>

<script>

let allDonors=[];



async function loadDonors(){

try{

const response = await fetch("/api/donors");

allDonors = await response.json();

renderDonors(allDonors);

}

catch(e){

document.getElementById("donorsList").innerHTML=

"<p style='color:red'>Failed loading donors</p>";

}

}



function renderDonors(donors){

const container=document.getElementById("donorsList");

const count=document.getElementById("donorCount");

if(!donors.length){

container.innerHTML="<p>No donors found</p>";

count.innerHTML="0 donors";

return;

}

count.innerHTML=

`Showing ${donors.length} donors`;

container.innerHTML=

donors.map(d=>`

<div class="donor-card">

<h3>${d.name}</h3>

<p>Blood : ${d.blood_type}</p>

<p>Age : ${d.age}</p>

<p>Email : ${d.email}</p>

<p>Phone : ${d.phone}</p>

<button onclick="deleteDonor(${d.id})">

Delete

</button>

</div>

`).join("");

}



async function deleteDonor(id){

if(!confirm("Delete donor?")) return;

await fetch(`/api/donors/${id}`,{

method:"DELETE"

});

loadDonors();

}



document.getElementById("search")

.addEventListener("input",function(){

const q=this.value.toLowerCase();

renderDonors(

allDonors.filter(d=>

d.name.toLowerCase().includes(q)

||

(d.email||"").toLowerCase().includes(q)

)

);

});



document.getElementById("blood")

.addEventListener("change",function(){

const b=this.value;

if(b==="all"){

renderDonors(allDonors);

return;

}

renderDonors(

allDonors.filter(d=>

d.blood_type===b)

);

});



loadDonors();

</script>

</body>

</html>
